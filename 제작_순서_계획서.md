# IBS 법률 AI 시스템 제작 순서 계획서

## 프로젝트 개요
IBS 법률 AI 시스템은 RAG(Retrieval-Augmented Generation) 기반의 법률 정보 제공 시스템입니다.
RAG DB에 저장된 법률 데이터를 활용하여 법률 상담, 판례 검색, 절차 안내 등의 서비스를 제공합니다.

## RAG DB 구성 요소 (10가지)
1. **법령 데이터** (statute)
2. **판례 요약 데이터** (case)
3. **절차 매뉴얼** (procedure)
4. **실무 매뉴얼** (manual)
5. **사건 유형 정의서** (case_type)
6. **사건별 템플릿 구조** (template)
7. **양형기준 요약** (sentencing_guideline)
8. **법률 FAQ** (faq)
9. **키워드-사건 맵핑** (keyword_mapping)
10. **스타일 문제 데이터** (style_issue)

---

## 제작 순서

### Phase 1: 프로젝트 기반 구조 설계 및 설정
**예상 기간: 1주**

#### 1.1 프로젝트 구조 생성
- [ ] 프로젝트 디렉토리 구조 설계
  - `data/` - 원본 데이터 저장
  - `data/processed/` - 처리된 데이터
  - `src/` - 소스 코드
  - `src/models/` - 데이터 모델
  - `src/processors/` - 데이터 처리 모듈
  - `src/rag/` - RAG 시스템
  - `src/api/` - API 서버
  - `config/` - 설정 파일
  - `tests/` - 테스트 코드
  - `docs/` - 문서

#### 1.2 개발 환경 설정
- [ ] Python 가상환경 설정
- [ ] requirements.txt 작성 (필요 라이브러리)
  - langchain / langgraph
  - vector DB (Chroma, Pinecone, 또는 FAISS)
  - embedding 모델 (OpenAI, 또는 한국어 모델)
  - FastAPI (API 서버)
  - pydantic (데이터 검증)
- [ ] .env.example 파일 생성
- [ ] README.md 작성

---

### Phase 2: 데이터 모델 및 스키마 정의
**예상 기간: 1주**

#### 2.1 공통 데이터 모델 설계
- [ ] BaseDocument 모델 정의 (id, category, sub_category, type, title, content, metadata)
- [ ] 각 데이터 타입별 Pydantic 모델 생성
  - [ ] StatuteModel (법령)
  - [ ] CaseModel (판례)
  - [ ] ProcedureModel (절차 매뉴얼)
  - [ ] ManualModel (실무 매뉴얼)
  - [ ] CaseTypeModel (사건 유형)
  - [ ] TemplateModel (템플릿)
  - [ ] SentencingGuidelineModel (양형기준)
  - [ ] FAQModel (FAQ)
  - [ ] KeywordMappingModel (키워드 맵핑)
  - [ ] StyleIssueModel (스타일 문제)

#### 2.2 JSON 스키마 검증 도구 개발
- [ ] JSON 스키마 검증기 작성
- [ ] 데이터 타입별 검증 규칙 정의

---

### Phase 3: 데이터 수집 및 변환 도구 개발
**예상 기간: 2주**

#### 3.1 데이터 수집 도구
- [ ] 법령 데이터 수집 스크립트
- [ ] 판례 데이터 수집 스크립트
- [ ] 매뉴얼 데이터 수집 스크립트
- [ ] FAQ 데이터 수집 스크립트

#### 3.2 데이터 변환 및 정제 도구
- [ ] JSON 변환기 개발
  - [ ] 원본 데이터 → 표준 JSON 형식 변환
  - [ ] 데이터 정제 및 검증
- [ ] 배치 처리 파이프라인 구축
- [ ] 데이터 중복 제거 로직
- [ ] 데이터 품질 검증 도구

#### 3.3 샘플 데이터 생성
- [ ] 각 데이터 타입별 샘플 JSON 파일 생성 (예시 참고)
- [ ] 테스트용 더미 데이터 생성

---

### Phase 4: 벡터 DB 설정 및 임베딩 파이프라인
**예상 기간: 1-2주**

#### 4.1 벡터 DB 선택 및 설정
- [ ] 벡터 DB 선택 (Chroma, Pinecone, FAISS 등)
- [ ] 벡터 DB 인스턴스 설정
- [ ] 컬렉션/인덱스 구조 설계
  - [ ] 데이터 타입별 컬렉션 분리 여부 결정
  - [ ] 메타데이터 필터링 구조 설계

#### 4.2 임베딩 모델 선택 및 설정
- [ ] 한국어 임베딩 모델 선택
  - [ ] OpenAI text-embedding-3-large (또는 한국어 최적화 모델)
  - [ ] 또는 Sentence-BERT 한국어 모델
- [ ] 임베딩 파이프라인 구축
  - [ ] 텍스트 청킹 전략 (법령, 판례 등 타입별)
  - [ ] 임베딩 생성 및 저장

#### 4.3 데이터 인덱싱 도구 개발
- [ ] JSON → 벡터 DB 인덱싱 스크립트
- [ ] 배치 인덱싱 파이프라인
- [ ] 증분 업데이트 로직
- [ ] 인덱싱 상태 모니터링

---

### Phase 5: RAG 시스템 핵심 로직 개발
**예상 기간: 2-3주**

#### 5.1 LangGraph 워크플로우 설계
- [ ] 검색 워크플로우 설계
  - [ ] 쿼리 분석 노드
  - [ ] 벡터 검색 노드
  - [ ] 메타데이터 필터링 노드
  - [ ] 결과 재랭킹 노드
  - [ ] 컨텍스트 구성 노드
- [ ] 라우팅 로직 (데이터 타입별 라우팅)
- [ ] 멀티 히스토리 관리

#### 5.2 검색 및 검색 강화 모듈
- [ ] 하이브리드 검색 구현 (벡터 + 키워드)
- [ ] 메타데이터 기반 필터링
- [ ] 검색 결과 재랭킹
- [ ] 컨텍스트 윈도우 최적화

#### 5.3 프롬프트 엔지니어링
- [ ] 각 데이터 타입별 프롬프트 템플릿 작성
- [ ] 시스템 프롬프트 정의
- [ ] 사용자 쿼리 → 프롬프트 변환 로직
- [ ] 프롬프트 버전 관리

#### 5.4 LLM 통합
- [ ] LLM 선택 및 설정 (GPT-4, Claude 등)
- [ ] 스트리밍 응답 처리
- [ ] 토큰 사용량 모니터링
- [ ] 에러 핸들링 및 재시도 로직

---

### Phase 6: API 서버 개발
**예상 기간: 1-2주**

#### 6.1 FastAPI 서버 구축
- [ ] FastAPI 애플리케이션 구조 설계
- [ ] 라우터 모듈화
  - [ ] `/search` - 검색 API
  - [ ] `/ask` - 질의응답 API
  - [ ] `/health` - 헬스체크
  - [ ] `/admin` - 관리 API (데이터 업데이트 등)

#### 6.2 API 엔드포인트 개발
- [ ] 검색 API (`POST /api/v1/search`)
  - [ ] 쿼리 파라미터
  - [ ] 필터 옵션 (category, sub_category, type 등)
  - [ ] 페이지네이션
- [ ] 질의응답 API (`POST /api/v1/ask`)
  - [ ] 대화 히스토리 관리
  - [ ] 스트리밍 응답
- [ ] 데이터 관리 API
  - [ ] 데이터 추가/업데이트
  - [ ] 인덱스 재구성

#### 6.3 인증 및 보안
- [ ] API 키 인증
- [ ] Rate limiting
- [ ] CORS 설정
- [ ] 입력 검증 및 sanitization

---

### Phase 7: 고급 기능 개발
**예상 기간: 2주**

#### 7.1 멀티 턴 대화 관리
- [ ] 대화 컨텍스트 관리
- [ ] 이전 대화 참조 로직
- [ ] 대화 세션 관리

#### 7.2 검색 결과 후처리
- [ ] 출처 표시 (법령 조문, 판례 번호 등)
- [ ] 관련 문서 추천
- [ ] 검색 결과 요약

#### 7.3 키워드-사건 맵핑 활용
- [ ] 키워드 기반 자동 분류
- [ ] 관련 사건 유형 추천
- [ ] 템플릿 자동 매칭

#### 7.4 스타일 문제 검증
- [ ] 생성된 텍스트 스타일 검증
- [ ] 법률 용어 정확성 검사
- [ ] 문법 및 형식 검증

---

### Phase 8: 테스트 및 검증
**예상 기간: 1-2주**

#### 8.1 단위 테스트
- [ ] 데이터 모델 테스트
- [ ] 데이터 처리 파이프라인 테스트
- [ ] 검색 로직 테스트
- [ ] API 엔드포인트 테스트

#### 8.2 통합 테스트
- [ ] 전체 워크플로우 테스트
- [ ] 벡터 DB 통합 테스트
- [ ] LLM 통합 테스트

#### 8.3 성능 테스트
- [ ] 검색 성능 벤치마크
- [ ] 동시 요청 처리 테스트
- [ ] 응답 시간 최적화

#### 8.4 정확도 검증
- [ ] 법률 지식 정확도 검증
- [ ] 판례 인용 정확도 검증
- [ ] 사용자 시나리오 테스트

---

### Phase 9: 모니터링 및 로깅
**예상 기간: 1주**

#### 9.1 로깅 시스템
- [ ] 구조화된 로깅 설정
- [ ] 검색 쿼리 로깅
- [ ] 에러 로깅 및 알림

#### 9.2 모니터링 대시보드
- [ ] API 사용량 모니터링
- [ ] 검색 성능 메트릭
- [ ] LLM 사용량 추적
- [ ] 벡터 DB 상태 모니터링

#### 9.3 알림 시스템
- [ ] 에러 알림
- [ ] 성능 임계값 알림
- [ ] 데이터 업데이트 알림

---

### Phase 10: 문서화 및 배포 준비
**예상 기간: 1주**

#### 10.1 문서화
- [ ] API 문서 작성 (Swagger/OpenAPI)
- [ ] 사용자 가이드 작성
- [ ] 개발자 가이드 작성
- [ ] 데이터 스키마 문서화

#### 10.2 배포 준비
- [ ] Docker 컨테이너화
- [ ] docker-compose 설정
- [ ] 환경 변수 관리
- [ ] 배포 스크립트 작성

#### 10.3 CI/CD 파이프라인
- [ ] GitHub Actions (또는 GitLab CI) 설정
- [ ] 자동 테스트 실행
- [ ] 자동 배포 파이프라인

---

## 우선순위별 개발 순서 요약

### 최우선 (MVP - Minimum Viable Product)
1. **Phase 1**: 프로젝트 구조 설계
2. **Phase 2**: 데이터 모델 정의
3. **Phase 3**: 샘플 데이터 생성 (최소한의 데이터)
4. **Phase 4**: 벡터 DB 설정 및 기본 임베딩
5. **Phase 5**: 기본 RAG 시스템 구축
6. **Phase 6**: 기본 API 서버
7. **Phase 8**: 기본 테스트

### 2차 우선순위 (핵심 기능 강화)
- **Phase 3**: 전체 데이터 수집 및 변환
- **Phase 5**: 고급 검색 및 라우팅
- **Phase 7**: 멀티 턴 대화 및 고급 기능

### 3차 우선순위 (운영 및 최적화)
- **Phase 9**: 모니터링 및 로깅
- **Phase 10**: 문서화 및 배포

---

## 기술 스택 제안

### 필수 라이브러리
- **LangChain / LangGraph**: RAG 워크플로우 구축
- **Vector DB**: Chroma (로컬) 또는 Pinecone (클라우드)
- **Embedding**: OpenAI text-embedding-3-large 또는 한국어 모델
- **LLM**: OpenAI GPT-4, Claude 3.5, 또는 한국어 LLM
- **API Framework**: FastAPI
- **Data Validation**: Pydantic
- **Database**: SQLite (메타데이터) 또는 PostgreSQL

### 선택적 라이브러리
- **로깅**: structlog
- **모니터링**: Prometheus, Grafana
- **테스트**: pytest, pytest-asyncio
- **문서화**: Sphinx 또는 MkDocs

---

## 예상 총 개발 기간
- **MVP**: 6-8주
- **전체 시스템**: 12-16주

---

## 참고 사항

### 데이터 타입별 특성 고려사항
1. **법령 데이터**: 조문 단위로 청킹, 조문 번호 메타데이터 중요
2. **판례 데이터**: 판결 요지와 판결 이유 분리, 키워드 추출 중요
3. **절차 매뉴얼**: 단계별 구조화, 순서 정보 중요
4. **템플릿**: 구조화된 템플릿 파싱 필요
5. **FAQ**: 질문-답변 쌍으로 인덱싱

### 확장 가능성
- 향후 새로운 데이터 타입 추가 용이하도록 모듈화
- 다양한 LLM 모델 지원 가능하도록 추상화
- 다양한 벡터 DB 지원 가능하도록 인터페이스 설계

---

## 다음 단계
1. 프로젝트 구조 생성 스크립트 작성
2. 기본 데이터 모델 코드 작성
3. 샘플 데이터 JSON 파일 생성
4. 기본 RAG 파이프라인 프로토타입 개발

